{{ define "main" }}
<section class="section">
  <div class="container">
    <div class="row">
      <div class="col-lg-12">
        <h2 class="mb-4">{{.Title }}</h2>
        <img src="{{.Params.Image | absURL }}" alt="{{.Site.Params.author}}" class="img-fluid w-100 mb-4">
        {{ .Content }}
        
        <!-- ğŸ“¨ ì´ë©”ì¼ í¼ -->
        <form id="contact-form" method="POST" action="{{ .Site.Params.contact_form_action }}" class="row mt-5">
          <div class="col-lg-6">
            <input type="text" class="form-control mb-4" name="name" id="name" placeholder="Name" required>
          </div>
          <div class="col-lg-6">
            <input type="email" class="form-control mb-4" name="email" id="email" placeholder="Email" required>
          </div>
          <div class="col-12">
            <textarea name="message" id="message" class="form-control mb-4" placeholder="Message..." required></textarea>
          </div>
          <div class="col-12">
            <button type="submit" class="btn btn-primary">Submit</button>
          </div>         
          
          <!-- âœ… ì„±ê³µ ë©”ì‹œì§€ -->
          <div id="thankyou_message" style="display:none;">
            <h2><em>Thanks</em> for contacting us! We will get back to you soon!</h2>
          </div>
        </form>

      </div>
    </div>
  </div>
</section>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const form = document.querySelector(".gfrom");
  
    form.addEventListener("submit", function (event) {
      event.preventDefault(); // ê¸°ë³¸ í¼ ì œì¶œ ë™ì‘ ë°©ì§€
  
      const formData = new FormData(form);
      const actionURL = form.getAttribute("action");
  
      // âœ… ìƒˆ ì°½ì„ ë¨¼ì € ì—´ê¸° (ìƒˆ íƒ­ ê°•ì œ ìƒì„±)
      const sendMailWindow = window.open("", "sendMailWindow", "width=500,height=400");
  
      if (!sendMailWindow) {
        alert("âŒ íŒì—… ì°¨ë‹¨ì´ ê°ì§€ë˜ì—ˆìŠµë‹ˆë‹¤. íŒì—…ì„ í—ˆìš©í•´ì£¼ì„¸ìš”.");
        return;
      }
  
      // âœ… ìƒˆ ì°½ì—ì„œ Google Apps Scriptì— í¼ ë°ì´í„° ìë™ ì œì¶œ
      sendMailWindow.document.write(`
        <html>
          <head><title>ë©”ì¼ ì „ì†¡ ì¤‘...</title></head>
          <body>
            <p>ë©”ì¼ì„ ë³´ë‚´ëŠ” ì¤‘ì…ë‹ˆë‹¤. ì ì‹œë§Œ ê¸°ë‹¤ë ¤ ì£¼ì„¸ìš”...</p>
            <form id="emailForm" action="${actionURL}" method="POST">
              <input type="hidden" name="name" value="${form.name.value}">
              <input type="hidden" name="email" value="${form.email.value}">
              <input type="hidden" name="message" value="${form.message.value}">
            </form>
            <script>
              document.getElementById("emailForm").submit();
            </script>
          </body>
        </html>
      `);
      sendMailWindow.document.close();
  
      // âœ… ìƒˆ ì°½ì´ ë‹«íˆëŠ” ê²ƒì„ ê°ì§€í•˜ê³  Contact í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨
      window.addEventListener("message", function (event) {
        if (event.data === "emailSent") {
          window.location.reload();  // Contact í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨
        }
      });
    });
  });
</script>


{{ partial "instafeed.html" . }}

{{ end }}
