{{ define "main" }}
<section class="section">
  <div class="container">
    <div class="row">
      <div class="col-lg-12">
        <h2 class="mb-4">{{.Title }}</h2>
        <img src="{{.Params.Image | absURL }}" alt="{{.Site.Params.author}}" class="img-fluid w-100 mb-4">
        {{ .Content }}
        
        <!-- 📨 이메일 폼 -->
        <form id="contact-form" method="POST" action="{{ .Site.Params.contact_form_action }}" class="row mt-5">
          <div class="col-lg-6">
            <input type="text" class="form-control mb-4" name="name" id="name" placeholder="Name" required>
          </div>
          <div class="col-lg-6">
            <input type="email" class="form-control mb-4" name="email" id="email" placeholder="Email" required>
          </div>
          <div class="col-12">
            <textarea name="message" id="message" class="form-control mb-4" placeholder="Message..." required></textarea>
          </div>
          <div class="col-12">
            <button type="submit" class="btn btn-primary">Submit</button>
          </div>         
          
          <!-- ✅ 성공 메시지 -->
          <div id="thankyou_message" style="display:none;">
            <h2><em>Thanks</em> for contacting us! We will get back to you soon!</h2>
          </div>
        </form>

      </div>
    </div>
  </div>
</section>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const form = document.querySelector(".gfrom");
  
    form.addEventListener("submit", function (event) {
      event.preventDefault(); // 기본 폼 제출 동작 방지
  
      const formData = new FormData(form);
      const actionURL = form.getAttribute("action");
  
      fetch(actionURL, {
        method: "POST",
        body: formData
      })
      .then(response => response.json())  // ✅ JSON 응답 받기
      .then(data => {
        if (data.status === "success") {
          console.log("✅ 메일 전송 완료:", data.message);
          alert("✅ 메일이 성공적으로 전송되었습니다!");
  
          // ✅ 창을 닫고 Contact 페이지를 다시 열기
          window.location.href = "/contact";
        } else {
          console.error("❌ 메일 전송 실패:", data.message);
          alert("❌ 메일 전송에 실패했습니다: " + data.message);
        }
      })
      .catch(error => {
        console.error("❌ 오류 발생:", error);
        alert("❌ 메일 전송 중 오류가 발생했습니다.");
      });
    });
  });
</script>


{{ partial "instafeed.html" . }}

{{ end }}
